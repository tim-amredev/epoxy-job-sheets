<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% if page.title %}{{ page.title }} | {{ site.title }}{% else %}{{ site.title }}{% endif %}</title>
  
  <!-- Favicon and Browser Icons -->
  {% include favicon.html %}
  
  <!-- Preconnect to external domains -->
  <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
  <link rel="preconnect" href="https://formsubmit.co" crossorigin>
  
  <!-- Web App Manifest -->
  <link rel="manifest" href="{{ '/manifest.json' | relative_url }}">
  
  <!-- Critical CSS inline -->
  <style>
    /* Critical CSS for above-the-fold content */
    :root {
      --primary-color: #ff0000;
      --secondary-color: #cc0000;
      --accent-color: #ff3333;
      --text-color: #e0e0e0;
      --text-muted: #a0a0a0;
      --light-text: #ffffff;
      --dark-bg: #121212;
      --card-bg: #1e1e1e;
      --header-bg: #0a0a0a;
      --border-color: #333333;
    }
    * {margin: 0; padding: 0; box-sizing: border-box;}
    body {
      font-family: "Arial", sans-serif;
      line-height: 1.6;
      color: var(--text-color);
      background-color: var(--dark-bg);
      -webkit-text-size-adjust: 100%;
      -webkit-tap-highlight-color: transparent;
    }
    .container {width: 100%; max-width: 1200px; margin: 0 auto; padding: 0 15px;}
    .site-header {
      background-color: var(--header-bg);
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
      padding: 0.75rem 0;
      position: sticky;
      top: 0;
      z-index: 100;
    }
    .site-header .container {display: flex; justify-content: space-between; align-items: center;}
    .logo-image {max-height: 60px; width: auto; object-fit: contain;}
  </style>
  
  <!-- Non-critical CSS with preload -->
  <link rel="preload" href="{{ '/assets/css/main.css' | relative_url }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="{{ '/assets/css/main.css' | relative_url }}"></noscript>
  
  <!-- Optimized Font Awesome loading -->
  <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"></noscript>
  
  <!-- LocalForage for offline storage -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/localforage/1.10.0/localforage.min.js" defer></script>
  
  <!-- Fallback for CSS loading -->
  <script>
    // Fallback for browsers that don't support preload
    !function(n){"use strict";n.loadCSS||(n.loadCSS=function(){});var o=loadCSS.relpreload={};if(o.support=function(){var e;try{e=n.document.createElement("link").relList.supports("preload")}catch(t){e=!1}return function(){return e}}(),o.bindMediaToggle=function(t){var e=t.media||"all";function a(){t.addEventListener?t.removeEventListener("load",a):t.attachEvent&&t.detachEvent("onload",a),t.setAttribute("onload",null),t.media=e}t.addEventListener?t.addEventListener("load",a):t.attachEvent&&t.attachEvent("onload",a),setTimeout(function(){t.rel="stylesheet",t.media="only x"}),setTimeout(a,3e3)},o.poly=function(){if(!o.support())for(var t=n.document.getElementsByTagName("link"),e=0;e<t.length;e++){var a=t[e];"preload"!==a.rel||"style"!==a.getAttribute("as")||a.getAttribute("data-loadcss")||(a.setAttribute("data-loadcss",!0),o.bindMediaToggle(a))}},!o.support()){o.poly();var t=n.setInterval(o.poly,500);n.addEventListener?n.addEventListener("load",function(){o.poly(),n.clearInterval(t)}):n.attachEvent&&n.attachEvent("onload",function(){o.poly(),n.clearInterval(t)})}"undefined"!=typeof exports?exports.loadCSS=loadCSS:n.loadCSS=loadCSS}("undefined"!=typeof global?global:this);
  </script>
  
  {% seo %}
</head>
<body class="{% if page.patriotic_page %}patriotic-theme{% endif %}">
  {% include header.html %}

  <main class="{% if page.patriotic_page %}patriotic-main{% endif %}">
    {{ content }}
  </main>

  {% include footer.html %}

  <!-- Defer non-critical JavaScript -->
  <script src="{{ '/assets/js/main.js' | relative_url }}" defer></script>
  
  <!-- Service Worker Registration -->
  {% include service-worker.html %}
</body>
</html>

